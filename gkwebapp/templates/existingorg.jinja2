<!DOCTYPE HTML >
<html>
<head>
  <link rel="stylesheet" type="text/css" media="screen" href="{{request.static_url('gkwebapp:static/css/bootstrap.min.css')}}" />
  <style>
  #subbutton{margin-top:2%}
  </style>


</head>
<body>

  <div class="container" id="inner">
    <div id="existingorg" style="margin-top:50px;" class="mainbox col-md-6 pull-right">
      <div class="panel panel-info" >
        <div class="panel-heading">
          <div class="panel-title">Select Organisation</div>

        </div>

        <div style="padding-top:30px" class="panel-body" >



          <form id="orgform" class="form-horizontal" role="form">

            <div style="margin-bottom: 25px" class="input-group">
              <span class="input-group-addon"><i class="glyphicon glyphicon-th-list"></i></span>
              <select class = "form-control" id="org-name"  name = "orgname" placeholder="Select Organisation">
                <option>Please Select</option>
                {% for orgs in gkresult %}
                <option value="{{orgs}}">{{orgs["orgname"]}} , {{orgs["orgtype"]}}</option>
                {% endfor %}
              </select>
            </div>

            <div style="margin-bottom: 25px" class="input-group">
              <span class="input-group-addon"><i class="glyphicon glyphicon-th-list"></i></span>
              <select class = "form-control" id="finalyears" name="orgcode" placeholder="Select Financial Year">


              </select>
            </div>






            <div style="margin-top:10px" class="form-group">
              <!-- Button -->

              <div class="col-sm-12 controls">
                <button id="callLogin" class="btn btn-success "><span class="glyphicon glyphicon-arrow-right"></span>Next</button>

              </div>
            </div>

          </form>



        </div>
      </div>

    </div>




  </div>
  <hr />

  <script src="{{request.static_url('gkwebapp:static/js/jquery-2.2.0.min.js')}}"></script>
  <script src="{{request.static_url('gkwebapp:static/js/bootstrap.min.js')}}"></script>
  <script>
  $(document).ready(function()
  {

    $("#org-name").bind("change keyup", function(){
      var org = $("#org-name option:selected").val();
      var orgobj = eval('('+org+')');
      $.ajax({
        type: "POST",
        url: "/yearcode",
        data: orgobj,
        global: false,
        async: false,
        dataType: "json",
        success: function(jsonObj) {
          ListofYears = jsonObj["gkresult"],
          $('#finalyears').empty();
          for (i in ListofYears ) {
            $('#finalyears').append('<option value="' + ListofYears[i].orgcode + '">' + ListofYears[i].yearstart+' to '+ListofYears[i].yearend + '</option>');
          }
        }

      });
    });
    $("#callLogin").click(function(event){
      event.preventDefault();
      var orgcode = $("#finalyears option:selected").val();
      $.ajax({
        type: "POST",
        url: "/login",
        data: {"orgcode":orgcode},
        global: false,
        async: false,
        dataType: "json",

      });
      $("#existingorg").load("/login");

    });
  });
  </script>
</body>

</html>
